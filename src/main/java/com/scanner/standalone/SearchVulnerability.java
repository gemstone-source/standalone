package com.scanner.standalone;

import io.restassured.path.json.JsonPath;
import org.json.simple.parser.ParseException;

import java.io.File;
import java.io.IOException;
import java.util.List;


public class SearchVulnerability{
    public static void main(String args[])  {
        File dir = new File("C:\\Users\\hashghost\\Desktop\\4xxx");
        showFiles(dir.listFiles());
    }
    public static void showFiles(File[] files){
        for(File file : files){

            if(file.isDirectory()){
                // System.out.println("Directory : " + file.getAbsolutePath());
                showFiles(file.listFiles());
            } else {
                try {
                    JsonPath jsonPath = JsonPath.from(file.getAbsoluteFile());

                    // Variable of application to be fetched
                    String app = "snowflake-jdbc";

                    String name = jsonPath.getString("containers.cna.affected.find{it.product == '" + app +"' }");
                    if (name != null) {
                        /*for (int i = 0; i< name.size(); i++) {
                            System.out.println(name.get(i));
                        }*/
                        System.out.println("Product name : " + jsonPath.getString("containers.cna.affected.product"));
                        System.out.println("Product cveID : " + jsonPath.getString("cveMetadata.cveId"));
                        System.out.println("Version : " + jsonPath.getString("containers.cna.affected.versions[0].version"));
                        System.out.println("Vulnerability : " + jsonPath.getString("containers.cna.descriptions[0].value"));
                        System.out.println("\n");
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }
}